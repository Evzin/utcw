/*! Ultimate Tag Cloud Widget - v2.0 alpha - 2012-10-01
* https://0x539.se/wordpress/ultimate-tag-cloud-widget/
* Copyright (c) 2012 Rickard Andersson; Licensed GPLv2 */
var Query=function(a){"use strict";var b=function(a){var b=[],c,d,e,f;if(typeof a=="undefined"||a===null||a==="")return b;a.indexOf("?")===0&&(a=a.substring(1)),d=a.toString().split(/[&;]/);for(c=0;c<d.length;c++)e=d[c],f=e.split("="),b.push([f[0],f[1]]);return b},c=b(a),d=function(){var a="",b,d;for(b=0;b<c.length;b++)d=c[b],a.length>0&&(a+="&"),a+=d.join("=");return a.length>0?"?"+a:a},e=function(a){return a=decodeURIComponent(a),a=a.replace("+"," "),a},f=function(a){var b,d;for(d=0;d<c.length;d++){b=c[d];if(e(a)===e(b[0]))return b[1]}},g=function(a){var b=[],d,f;for(d=0;d<c.length;d++)f=c[d],e(a)===e(f[0])&&b.push(f[1]);return b},h=function(a,b){var d=[],f,g,h,i;for(f=0;f<c.length;f++)g=c[f],h=e(g[0])===e(a),i=e(g[1])===e(b),(arguments.length===1&&!h||arguments.length===2&&!h&&!i)&&d.push(g);return c=d,this},i=function(a,b,d){return arguments.length===3&&d!==-1?(d=Math.min(d,c.length),c.splice(d,0,[a,b])):arguments.length>0&&c.push([a,b]),this},j=function(a,b,d){var f=-1,g,j;if(arguments.length===3){for(g=0;g<c.length;g++){j=c[g];if(e(j[0])===e(a)&&decodeURIComponent(j[1])===e(d)){f=g;break}}h(a,d).addParam(a,b,f)}else{for(g=0;g<c.length;g++){j=c[g];if(e(j[0])===e(a)){f=g;break}}h(a),i(a,b,f)}return this};return{getParamValue:f,getParamValues:g,deleteParam:h,addParam:i,replaceParam:j,toString:d}},Uri=function(a){"use strict";var b=!1,c=function(a){var c={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},d=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],e={name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},f=c[b?"strict":"loose"].exec(a),g={},h=14;while(h--)g[d[h]]=f[h]||"";return g[e.name]={},g[d[12]].replace(e.parser,function(a,b,c){b&&(g[e.name][b]=c)}),g},d=c(a||""),e=new Query(d.query),f=function(a){return typeof a!="undefined"&&(d.protocol=a),d.protocol},g=null,h=function(a){return typeof a!="undefined"&&(g=a),g===null?d.source.indexOf("//")!==-1:g},i=function(a){return typeof a!="undefined"&&(d.userInfo=a),d.userInfo},j=function(a){return typeof a!="undefined"&&(d.host=a),d.host},k=function(a){return typeof a!="undefined"&&(d.port=a),d.port},l=function(a){return typeof a!="undefined"&&(d.path=a),d.path},m=function(a){return typeof a!="undefined"&&(e=new Query(a)),e},n=function(a){return typeof a!="undefined"&&(d.anchor=a),d.anchor},o=function(a){return f(a),this},p=function(a){return h(a),this},q=function(a){return i(a),this},r=function(a){return j(a),this},s=function(a){return k(a),this},t=function(a){return l(a),this},u=function(a){return m(a),this},v=function(a){return n(a),this},w=function(a){return m().getParamValue(a)},x=function(a){return m().getParamValues(a)},y=function(a,b){return arguments.length===2?m().deleteParam(a,b):m().deleteParam(a),this},z=function(a,b,c){return arguments.length===3?m().addParam(a,b,c):m().addParam(a,b),this},A=function(a,b,c){return arguments.length===3?m().replaceParam(a,b,c):m().replaceParam(a,b),this},B=function(){var a="",b=function(a){return a!==null&&a!==""};return b(f())?(a+=f(),f().indexOf(":")!==f().length-1&&(a+=":"),a+="//"):h()&&b(j())&&(a+="//"),b(i())&&b(j())&&(a+=i(),i().indexOf("@")!==i().length-1&&(a+="@")),b(j())&&(a+=j(),b(k())&&(a+=":"+k())),b(l())?a+=l():b(j())&&(b(m().toString())||b(n()))&&(a+="/"),b(m().toString())&&(m().toString().indexOf("?")!==0&&(a+="?"),a+=m().toString()),b(n())&&(n().indexOf("#")!==0&&(a+="#"),a+=n()),a},C=function(){return new Uri(B())};return{protocol:f,hasAuthorityPrefix:h,userInfo:i,host:j,port:k,path:l,query:m,anchor:n,setProtocol:o,setHasAuthorityPrefix:p,setUserInfo:q,setHost:r,setPort:s,setPath:t,setQuery:u,setAnchor:v,getQueryParamValue:w,getQueryParamValues:x,deleteQueryParam:y,addQueryParam:z,replaceQueryParam:A,toString:B,clone:C}},jsUri=Uri;(function(a){a.fn.wTooltip=function(b,c){function p(c){c&&(b.degrade?a(l).html(b.content.replace(/<\/?[^>]+>/gi,"")):a(l).html(b.content))}function q(c){function e(a){d&&!b.content&&(d="")}function h(){!j&&b.auto&&(clearInterval(g),b.fadeOut?a(l).fadeOut(b.fadeOut,function(){e(c)}):(e(c),l.style.display="none")),typeof b.callAfter=="function"&&b.callAfter(l,c,b),n&&(b=a.listen(b))}b.timeout>0?f=setTimeout(function(){h()},b.timeout):h()}b=a.extend({content:null,ajax:null,follow:!0,auto:!0,fadeIn:0,fadeOut:0,appendTip:document.body,degrade:!1,offsetY:10,offsetX:1,style:{},className:null,id:null,callBefore:function(a,b,c){},callAfter:function(a,b,c){},clickAction:function(b,c){a(b).hide()},delay:0,timeout:0},b||{}),!b.style&&typeof b.style!="object"?(b.style={},b.style.zIndex="1000"):b.style=a.extend({border:"1px solid gray",background:"#edeef0",color:"#000",padding:"10px",zIndex:"1000",textAlign:"left"},b.style||{}),typeof c=="function"&&(b.callAfter=c||b.callAfter),b.style.display="none",b.style.position="absolute";var d,e,f,g,h={},i=!0,j=!1,k=!1,l=document.createElement("div"),m=typeof document.body.style.maxWidth=="undefined"?!0:!1,n=typeof a.talk=="function"&&typeof a.listen=="function"?!0:!1;b.id&&(l.id=b.id),b.className&&(l.className=b.className),b.degrade=b.degrade&&m?!0:!1;for(var o in b.style)l.style[o]=b.style[o];return b.ajax&&a.get(b.ajax,function(a){a&&(b.content=a),p(b.content)}),a(l).hover(function(){j=!0},function(){j=!1,q(h)}),n&&(b.key=l,b.plugin="wTooltip",b.channel="wayfarer",a.talk(b)),p(b.content&&!b.ajax),a(l).appendTo(b.appendTip),this.each(function(){a(this).hover(function(){function g(){typeof b.callBefore=="function"&&b.callBefore(l,c,b),n&&(b=a.listen(b));var e;b.content?b.degrade||(e="block"):d&&!b.degrade?(a(l).html(unescape(d)),e="block",d=""):e="none",b.auto&&(e=="block"&&b.fadeIn?a(l).fadeIn(b.fadeIn):l.style.display=e)}var c=this;clearTimeout(f),(this.title||this.titleMemKeep)&&!b.degrade&&!b.content&&(d=this.title||this.titleMemKeep,this.title&&(this.titleMemKeep=this.title,this.title="")),b.content&&b.degrade&&(this.title=l.innerHTML),b.delay>0?e=setTimeout(function(){g()},b.delay):g()},function(){clearTimeout(e);var c=this;i=!0,!b.follow||k||b.offsetX<0&&0-b.offsetX<a(l).outerWidth()&&b.offsetY>0&&0-b.offsetY<a(l).outerHeight()?setTimeout(function(){g=setInterval(function(){q(c)},1)},1):q(this)}),a(this).mousemove(function(c){h=this;if(b.follow||i){var d=a(window).scrollTop(),e=a(window).scrollLeft(),f=c.clientY+d+b.offsetY,g=c.clientX+e+b.offsetX,j=a(b.appendTip).outerHeight(),m=a(b.appendTip).innerHeight(),n=a(window).width()+e-a(l).outerWidth(),o=a(window).height()+d-a(l).outerHeight();f=j>m?f-(j-m):f,k=f>o||g>n?!0:!1,g-e<=0&&b.offsetX<0?g=e:g>n&&(g=n),f-d<=0&&b.offsetY<0?f=d:f>o&&(f=o),l.style.top=f+"px",l.style.left=g+"px",i=!1}}),typeof b.clickAction=="function"&&a(this).click(function(){b.clickAction(l,this)})})}})(jQuery),function(a){var b={activeTab:{},tooltipStyle:{border:"solid 1px #6295fb",background:"#fff",color:"#000",padding:"5px",zIndex:1e3},init:function(){a("input[id$=-color_none], input[id$=-color_random], input[id$=-color_set], input[id$=-color_span]").live("click",this.colorClickHandler),a(".utcw-tab-button").live("click",this.tabClickHandler),a("select[id$=-taxonomy]").live("change",this.taxonomyChangeHandler),a(document).ready(this.initTooltip),a(document).ajaxSuccess(this.ajaxSuccessHandler)},initTooltip:function(){a(".utcw-help").wTooltip({style:this.tooltipStyle,className:"utcw-tooltip"})},tabClickHandler:function(){var c=a(this);return c.data("id")==="utcw-__i__"?!1:(c.parent().find(".utcw-tab-button").removeClass("utcw-active"),c.addClass("utcw-active"),c.parent().find("fieldset.utcw").addClass("hidden"),a("#"+c.data("tab")).removeClass("hidden"),b.activeTab[c.data("id")]=c.data("tab"),!1)},colorClickHandler:function(){var b=a("div[id$='set_chooser']"),c=a("div[id$='span_chooser']"),d=a(this).val();b.addClass("utcw-hidden"),c.addClass("utcw-hidden"),d==="set"?b.removeClass("utcw-hidden"):d==="span"&&c.removeClass("utcw-hidden")},taxonomyChangeHandler:function(){var b=a(this),c=b.find(":selected").val(),d=b.parents(".widget-content");d.find("div[id$=-terms]").addClass("hidden"),d.find("#"+c+"-terms").removeClass("hidden")},ajaxSuccessHandler:function(c,d,e){var f=new Uri,g;f.setQuery(decodeURI(e.data)),f.getQueryParamValue("action")==="save-widget"&&f.getQueryParamValue("id_base")==="utcw"&&(g=f.getQueryParamValue("widget-id"),b.activeTab[g]&&a("button[data-tab='"+b.activeTab[g]+"']").trigger("click"))}};b.init()}(jQuery);